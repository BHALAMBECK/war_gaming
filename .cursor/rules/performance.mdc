# Performance Guidelines

## FPS Targets
- 60 FPS for 500 agents (decent laptop).
- 30 FPS acceptable for 5,000 agents with simplified visuals.
- Monitor FPS in dev mode, provide overlay toggle.

## Profiling Hooks
- Use `performance.now()` for sim step timing.
- Log sim step duration if >16ms (60 FPS threshold).
- Provide FPS overlay UI component (toggleable).

## Agent Scaling Strategy
- Use instanced rendering (`InstancedMesh` or `Points`) for many agents.
- LOD: reduce detail beyond certain distance or agent count.
- Cull off-screen agents (frustum culling).
- Batch updates: update all agent positions in single loop, then render.

## Sim/Render Decoupling
- Sim step runs at fixed delta (e.g., 1 second), independent of frame rate.
- Use `useFrame` for render loop, separate sim clock for physics.
- Cap sim steps per frame to prevent lag spikes (max 10 steps per frame).

## Optimization Checklist
- [ ] Instanced rendering for agents
- [ ] Frustum culling
- [ ] LOD for distant agents
- [ ] Sim step profiling
- [ ] FPS overlay toggle
- [ ] WebWorker for sim (optional, later milestone)
